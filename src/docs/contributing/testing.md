# Writing tests

In this guide, we'll walk through writing test for our [custom `Checkbox` component](creating.md) in [Storybook](https://storybook.js.org/).

DRY uses [Jest](https://jestjs.io/) and [React Testing Library](https://testing-library.com/docs/react-testing-library/intro) for testing.

## Directory

All of DRY's component test files are scoped in the same directory as the component, example:

```
DRY-react/
  └── components/
      └── FormHealpers/
          └──Checkbox
```

## Initial files

Under `Checkbox`, we'll need to create the main `Checkbox.test.js` file:

```
DRY-react/
  └── components/
      └── FormHealpers/
          └──Checkbox
             └──Checkbox.test.js
```

## Base test code

In our `Checkbox/Checkbox.test.js` file, we'll need to add:

```jsx
import React from "react";
import { render, fireEvent, waitFor, screen } from "@testing-library/react";
import "@testing-library/jest-dom/extend-expect";

import Checkbox from "./Checkbox";

describe("classNames", () => {
  test("Has default className", () => {});
});
```

#### `data-testid`

DRY favours dealing with instances of rendered React components, your tests will work with actual DOM nodes. The utilities this library provides facilitate querying the DOM in the same way the user would. Finding form elements by their label text (just like a user would), finding links and buttons from their text (like a user would). It also exposes a recommended way to find elements by a `data-testid` as an "escape hatch" for elements where the text content and label do not make sense or is not practical.

## Test development

For test development, open up your terminal and run the following command:

```
npm run dev
```

This fires up Jest in watch mode, and runs tests against modified files (and their associated files).

## Code coverage

![Coverage report, generated by Jest](../images/test-coverage.jpg)

To check code coverage, run the following command:

```
npm run test
```

This runs through the entire Jest test suite, and generates a [coverage report](https://istanbul.js.org/) under:

```
DRY-react/
  └── coverage/
      └── lcov-report/
          └── index.html
```

You can open the `index.html` in your browser to view the full report.

DRY Aims for **95% code coverage**for tests. Because DRY is a component library (rather than an App), it's testing coverage is stricter. Everything must be tested. There are no exceptions... Except...

## Exceptions

...the strange or untestable cases within the [JSDOM](https://github.com/jsdom/jsdom) environment (which Jest runs on). (lol). Many DOM APIs are **not supported** in JSDOM (e.g. height/width calculations, scrolling, positioning, etc...).

Sweet! `Checkbox` is now super reliable, thanks to tests!

## Next

Let's [write some documentation](documentation.md) to make sure other folks know how to use `Checkbox`.

## See also

- [Resource On RTL](https://jkettmann.com/beginners-guide-to-testing-react/)
- [Jest](https://jestjs.io/)
- [React Testing Library](https://testing-library.com/docs/react-testing-library/intro)
- [Coveralls](https://coveralls.io/)
